<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="Colin Hughes" name="author"/>
<meta content="A website dedicated to the fascinating world of mathematics and programming" name="description"/>
<meta content="programming,mathematics,problems,puzzles" name="keywords"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>#696 Mahjong - Project Euler</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet"/>
<link href="favicons/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180"/>
<link href="favicons/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="favicons/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png"/>
<link href="favicons/site.webmanifest" rel="manifest"/>
<link color="#da532c" href="favicons/safari-pinned-tab.svg" rel="mask-icon"/>
<link href="favicons/favicon.ico" rel="shortcut icon"/>
<meta content="#da532c" name="msapplication-TileColor"/>
<meta content="favicons/browserconfig.xml" name="msapplication-config"/>
<meta content="#ffffff" name="theme-color"/>
<link href="themes/style_main.1724940352.css" rel="stylesheet" type="text/css"/>
<link href="themes/style_default.1627113674.css" rel="stylesheet" type="text/css"/>
<script src="js/mathjax_config.js"></script>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?version=4.8.0&amp;features=es6"></script>
<script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script></head>
<body>
<div id="container">
<header>
<div>
<img alt="Project Euler" id="logo" src="themes/logo_default.png"/>
</div>
<div id="info_panel">
		   <a href="search"><img alt="Search Problems" class="icon" src="images/icons/search_engine.png" title="Search Problems"/></a>   <a href="rss2_euler.xml"><img alt="RSS Feed" class="icon" src="images/icons/news_feed.png" title="RSS Feed"/></a>
</div>
</header>
<nav>
<input class="nav_toggle" id="nav_toggle" type="checkbox"/>
<label class="nav_toggle_label" for="nav_toggle"><i class="fas fa-bars" id="nav_toggle_icon"></i></label>
<ul>
<li><a href="about">About</a></li>
<li><a href="archives" id="current">Archives</a></li>
<li><a href="recent">Recent</a></li>
<li><a href="news">News</a></li>
<li><a href="register">Register</a></li>
<li><a href="sign_in">Sign In</a></li>
</ul>
</nav>
<div id="content">
<div class="center print"><img alt="projecteuler.net" src="images/clipart/print_page_logo.png"/></div>
<h2>Mahjong</h2><div class="noprint" id="problem_icons"><a href="minimal=696"><img class="icon" src="images/icons/file_html.png" title="Show HTML problem content"/></a> <span class="tooltip"><img class="icon" src="images/icons/info.png"/><span class="tooltiptext_right">Published on Sunday, 5th January 2020, 01:00 am; Solved by 189;<br/>Difficulty rating: 100%</span></span></div><div id="problem_info"><h3>Problem 696</h3></div>
<div class="problem_content" role="problem">
<p>The game of Mahjong is played with tiles belonging to $s$ <dfn>suits</dfn>. Each tile also has a <dfn>number</dfn> in the range $1\ldots n$, and for each suit/number combination there are exactly four indistinguishable tiles with that suit and number. (The real Mahjong game also contains other bonus tiles, but those will not feature in this problem.)</p>
<p>A <dfn>winning hand</dfn> is a collection of $3t+2$ Tiles (where $t$ is a fixed integer) that can be arranged as $t$ <dfn>Triples</dfn> and one <dfn>Pair</dfn>, where:</p>
<ul>
<li>A <dfn>Triple</dfn> is either a <dfn>Chow</dfn> or a <dfn>Pung</dfn></li>
<li>A <dfn>Chow</dfn> is three tiles of the same suit and consecutive numbers</li>
<li>A <dfn>Pung</dfn> is three identical tiles (same suit and same number)</li>
<li>A <dfn>Pair</dfn> is two identical tiles (same suit and same number)</li>
</ul>
<p>For example, here is a winning hand with $n=9$, $s=3$, $t=4$, consisting in this case of two Chows, two Pungs, and one Pair:</p>
<div class="center">
<img alt="A winning Mahjong hand" src="resources/images/0696_mahjong_1.png?1678992054"/>
</div>
<p>Note that sometimes the same collection of tiles can be represented as $t$ Triples and one Pair in more than one way. This only counts as one winning hand. For example, this is considered to be the same winning hand as above, because it consists of the same tiles:</p>
<div class="center">
<img alt="Alternative arrangement of the same hand" src="resources/images/0696_mahjong_2.png?1678992054"/>
</div>
<p>Let $w(n, s, t)$ be the number of distinct winning hands formed of $t$ Triples and one Pair, where there are $s$ suits available and tiles are numbered up to $n$.</p>
<p>For example, with a single suit and tiles numbered up to $4$, we have $w(4, 1, 1) = 20$: there are $12$ winning hands consisting of a Pung and a Pair, and another $8$ containing a Chow and a Pair. You are also given that $w(9, 1, 4) = 13259$, $w(9, 3, 4) = 5237550$, and $w(1000, 1000, 5) \equiv 107662178 \pmod{1\,000\,000\,007}$.</p>
<p>Find $w(10^8, 10^8, 30)$. Give your answer modulo $1\,000\,000\,007$.</p>
</div><br/>
<br/>
</div> <!--end_content-->
</div> <!--end_container-->
<div class="noprint" id="footer">
Project Euler: <a href="copyright">Copyright Information</a> | <a href="privacy">Privacy Policy</a>
</div>
<div id="modal_window">
<div class="message_body" id="modal_content">
<p>The page has been left unattended for too long and that link/button is no longer active. Please refresh the page.</p>
</div>
</div>
<script id="page_expire" type="application/json">86400</script>
<script src="js/general.1681854148.js"></script>
</body>
</html>
